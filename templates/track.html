{% extends "layout.html" %}

{% block body %}

<div class="track-request" style="justify-content: center;text-align: center; align-items: center;">
    <div class="track-request-left" style="justify-content: center;text-align: center; align-items: center;">
        <div class="code-box" style="justify-content: center;text-align: center; align-items: center;">
            <h2>Track a Request!</h2>
            <form method="GET" action="/track">
            <input type="text" pattern="^[0-9]{4-5}$" name="code" placeholder="Appliance/Request Code">
            <input type="submit" value="search">
            </form>
        </div>
        {% if applianceInfo is not none %}
        <div class="track-request-right">
            <h1>{{applianceInfo.applianceName}} ({{applianceInfo.code}})</h1>
            <h2>Building: {{applianceInfo.building}}</h2>
            <h2>Floor: {{applianceInfo.floor}}<h2>
            <a href={{url_for('makeRequest',code=applianceInfo.code)}}>Start a New Request</a>
        </div>
        {% else %}
        <div class="track-request-right">
            <h1>No appliance selected.</h1>
        </div>
        {% endif %}
    </div>
    <div class="track-request-list">

        
        {% if requestInfo is not none %}
            {% for request in requestInfo %}
                <div class="request-row {{'resolved' if request.status != 'pending'}}">
                    <h1 class="request-title">{{request.subject}}</h1>
                    <h4 class="status">{{request.status.upper()}}</h4>
                    <p><strong>Filed on:</strong> {{request.date}}</p>
                    <p><strong>Requested By:</strong> {{request.fullName}} ({{request.email}})</p>
                    <p><strong>Description:</strong> {{request.description}}</p>
                    <a href={{url_for('trackRequestDetailed',ticket=request.ticket)}}>More Details</a>
                </div>
            {% endfor %}
        {% else %}
            <h1>No requests found.</h1>
        {% endif %}

    </div>

</div>


{% endblock %}